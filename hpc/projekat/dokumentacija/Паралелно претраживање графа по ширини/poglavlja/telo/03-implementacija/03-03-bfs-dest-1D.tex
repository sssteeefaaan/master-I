\section{Паралелна имплементација \textit{BFS} алгоритма са дистрибуираном меморијом и једнодимензионим партиционисањем чворова}
У оквиру ове имплементације, граф је представљен користећи матрицу суседства, односно са два низа, један који представља назубљену матрицу потега и други који представља помераје за одговарајући чвор у матрици потега. Овакво представљање графа је објашњено у секцији \ref{graph-as-sparse-matrix}. Функција која имплементира паралелни \textit{BFS} са дистрибуираном меморијом је дефинисана у исечку \ref{code:bfs-dist-general}. Функција \cinline{void bfs_dist(...)} прима:
\begin{enumerate}
    \item\cinline{long long* graph} - низ целобројних вредности који садржи сегменте за суседе одговарајућих темена,
    \item\cinline{long long* degrees} - низ целобројних вредности који садржи помераје у оквиру низа\cinline{graph},
    \item\cinline{long long vertex_numb} - целобројна вредност која представља број потега у графу, односно димензију низа\cinline{degrees} (\cinline{vertex_numb + 1}),
    \item\cinline{long long start} - целобројна вредност која представља индекс почетног чвора у оквиру низа\cinline{degrees} и
    \item\cinline{long long* distance} - низ целобројних вредности у оквиру којих ће бити бележено растојање од почетног чвора \cinline{start} до чвора $v_i$ представљено у виду броја суседа који деле ова два чвора.
\end{enumerate}

\par
Подразумева се да је граф иницијализован у процесу са ранком \cinline{MASTER} коришћењем функције \ref{code:generate-random-graph}, док су сви процеси позвали функцију \cinline{void bfs_dist(...)}. У оквиру линија 78-83 се врши стандардна иницијализација променљивих \cinline{rank} и\cinline{size} за генерални комуникатор \cinline{MPI_COMM_WORLD}, док се у оквиру променљиве \cinline{work_load} рачуна целобројна вредност која представља број индекса који треба да обради сваки од процесора $work\_load = \ceil*{\frac{|V|}{|P|}}$. 

\begin{listing}[H]
\centering
\inputminted[fontsize={\fontsize{5}{5}\selectfont},firstline=71,lastline=158]{c}{kodovi/bfs-dist-general-1d.c}
\caption{\textit{Паралелна имплементација \textit{BFS} алгоритма са дистрибуираном меморијом и једнодимензионим партиционисањем темена}}
\label{code:bfs-dist-general}
\end{listing}

\par
С обзиром да се граф налази у два низа, \cinline{degress} и \cinline{graph}, који су иницијализовани у оквиру процеса са ранком \cinline{rank}, неопходно је проследити податке осталим процесима, што се одвија у оквиру линија 85 и 88 респективно. У оквиру линија 86 и 87 се филтрирају не-\textit{MASTER} процеси, јер они немају алоциран низ \cinline{graph} (величина овог низа није позната унапред, већ се добија динамички, насумичним генерисањем графа).

\par
У оквиру линија 90-93 се врши иницијализација локалног низа за сваки процес, у који се бележе растојања стартног чвора на \cinline{INFINITY}, док се растојање до стартног чвора поставља на $0$.

\par
У оквиру линија 95-98 се врши иницијализација низова: \cinline{F}, \cinline{N}, \cinline{N_recv} и \cinline{N_size}. Низови \cinline{F} и\cinline{NS} имају идентичну улогу као и у алгоритму \ref{pseudocode:algorithm-bfs-distance-1D-par-pseudo}, док низови \cinline{N_recv} и \cinline{N_size} бележе индексе који се размењују са осталим процесима у итерацији и величину сваког од низева коју прву шаљу одређеном процесу, а када размене величине, примају низ те дужине, респективно.

\par
У оквиру линија 100-103 се врши иницијализација променљивих: \cinline{level}, \cinline{F_count}, \cinline{F_global_count} и \cinline{my\_size}. Променљива \cinline{level} бележи тренутни ниво итерације која се обрађује. Променљива \cinline{F_count} бележи локалну дужину низа \cinline{F} за процес, док променљива \cinline{F_global_count} служи да би се у њу касније примила редукована вредност суме \cinline{F_count} променљивих од свих процеса. Променљива \cinline{my_size} се користи да би се у њу примила вредност која представња дужину низа који се размењује са процесима при разврставању низа локалних темена.

\par
У оквиру линије 105 започиње бесконачна \cinline{while} петља коју извршавају сви процеси све док је задовољен услов да \cinline{F} има елементе бар у једном процесу. Ова логика је имплементирана у оквиру линија 107-116, где сваки процес прво уписује сва темена која се налазе на растојању једнаком тренутној вредности променљиве \cinline{level} у низ \cinline{F}. Након тога се врши $all-reduce$ операција над променљивама \cinline{F_count} и вредност уписује у \cinline{F_global_count}. Након тога се у линији 115 проверава вредност променљиве \cinline{F_global_count} и уколико је $0$, биће нула за све процесе и сви ће изаћи на линији 116.

\par
Даље, у линијама 118 и 119 се врши иницијализација елемената низа \cinline{N_size} на 0, с обзиром да ће се у том низу налазити дужине скупова \cinline{N_q} из алгоритма \ref{pseudocode:algorithm-bfs-distance-1D-par-pseudo} који ће се размењивати са осталим процесима.

\par
У оквиру петље у линијама 121-136 се врши пролаз кроз низ \cinline{F} сваког од процеса, проналазе се суседна темена (петља у линијама 125-135) и аутоматски разврставају и уписују у одговарајуће сегменте низа \cinline{N}, док се величина сваког сегмента бележи у оквиру низа \cinline{N_size}.

\par
У оквиру петље на линијама 138-146 се врши размена величина низова \cinline{N_q} који се размењују са процесом $q$ на основу алгоритма \ref{pseudocode:algorithm-bfs-distance-1D-par-pseudo}, а затим се и врши размена тих низова и уписује у низ \cinline{N_recv}. Из овог низа се разматрају темена која представљају локална гранична темена за процес и уколико се није забележило растојање до њих, то се дешава у линијама 143-145. На крају \cinline{while} петље се врши инкрементирање промељиве \cinline{level}, чиме се отпочиње следећа итерација.

\par
Када више ниједан процес нема граничних темена, то значи да су се од почетног чвора истражила сва темена до којих постоје потези, те се у оквиру линије 151 врши редукција локалног низа растојања \cinline{d} и редуковане вредности уписују у низ \cinline{distance}. У оквиру линија 153-157 се врши деалоцирање низова које је алоцирала функција и то у обрнутом редоследу, што су и њене последње нструкције.

\subsection{Перформансе паралелне имплементације \textit{BFS} алгоритма са једнодимензионим партиционисањем}
Дијаграм који илуструје однос броја чворова и времена потребног за проналажење растојања до досежних чворова из почетног чвора је приказан на слици \ref{diagram:bfs-dist-1D-vertex-numb-variable}. Подаци су приказани и у оквиру табеле \ref{table:bfs-dist-1D-vertex-variable}.

\begin{table}[H]
    \centering
\rowcolors{2}{light blue}{}
\begin{tabular}{| m{.15\textwidth} | m{.15\textwidth} | m{.15\textwidth} | m{.15\textwidth} | m{.15\textwidth} |}
    \hline \rowcolor{dark blue}
     \textbw{Број темена} & \textbw{Максималан број потега} & \textbw{Минималан број потега} & \textbw{Време извршавања} & \textbw{Број процеса} \\ \hline
         50 & 10 & 1 & 0.000818 & 10 \\ \hline
         100 & 10 & 1 & 0.000531 & 10 \\ \hline
         500 & 10 & 1 & 0.001006 & 10 \\ \hline
         1000 & 10 & 1 & 0.000723 & 10 \\ \hline
         5000 & 10 & 1 & 0.001419 & 10 \\ \hline
         10000 & 10 & 1 & 0.002502 & 10 \\ \hline
         50000 & 10 & 1 & 0.009297 & 10 \\ \hline
         100000 & 10 & 1 & 0.016624 & 10 \\ \hline
         500000 & 10 & 1 & 0.094666 & 10 \\ \hline
         1000000 & 10 & 1 & 0.336910 & 10 \\ \hline
    \end{tabular}
    \caption{\textit{Перформансе паралелне имплементације \textit{BFS} алгоритма са дисртибуираном меморијом и једнодимензионим партиционисањем са променом броја темена}}
    \label{table:bfs-dist-1D-vertex-variable}
\end{table}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                xtick={100, 1000, 10000, 100000, 10000000},
                xmode=log,
                log ticks with fixed point,
                xlabel={Број темена},
                ylabel={Време извршења},
                width=.7\columnwidth
                ]
            \addplot+
            table[x=VN, y=T]{testovi/dist-1D-vertex-numb-variable.txt};
        \end{axis}
    \end{tikzpicture}
    \caption{\textit{Зависност времена извршења паралелне имплементације \textit{BFS} алгоритма са дистрибуираном меморијом и једнодимензионим партиционисањем од броја темена}}
    \label{diagram:bfs-dist-1D-vertex-numb-variable}
\end{figure}

\par
Дијаграм који илуструје однос броја потега и времена потребног за проналажење растојања до досежних чворова из почетног чвора је приказан на слици \ref{diagram:bfs-dist-1D-edge-numb-variable}. Подаци су приказани и у оквиру табеле \ref{table:bfs-dist-1D-edge-variable}.

\begin{table}[H]
\centering
\rowcolors{2}{light blue}{}
\begin{tabular}{| m{.15\textwidth} | m{.15\textwidth} | m{.15\textwidth} | m{.15\textwidth} | m{.15\textwidth} |}
    \hline \rowcolor{dark blue}
     \textbw{Број темена} & \textbw{Максималан број потега} & \textbw{Минималан број потега} & \textbw{Време извршавања} & \textbw{Број процеса} \\ \hline
     1000 & 1 & 1 & 0.000453 & 10 \\ \hline
     1000 & 5 & 1 & 0.000244 & 10 \\ \hline
     1000 & 10 & 5 & 0.000398 & 10 \\ \hline
     1000 & 50 & 10 & 0.000926 & 10 \\ \hline
     1000 & 100 & 50 & 0.002091 & 10 \\ \hline
     1000 & 500 & 100 & 0.014035 & 10 \\ \hline
     1000 & 1000 & 500 & 0.037758 & 10 \\ \hline
     1000 & 1000 & 1000 & 0.036923 & 10 \\ \hline
     2000 & 2000 & 2000 & 0.242799 & 10 \\ \hline
\end{tabular}
\caption{\textit{Перформансе паралелне имплементације \textit{BFS} алгоритма са дисртибуираном меморијом и једнодимензионим партиционисањем са променом степена повезаности}}
\label{table:bfs-dist-1D-edge-variable}
\end{table}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                xmode=log,
                log ticks with fixed point,
                xlabel={Просечан број потега},
                ylabel={Време извршења},
                width=.7\columnwidth
                ]
            \addplot+
            table[x=EN, y=T]{testovi/dist-1D-edge-numb-variable.txt};
        \end{axis}
    \end{tikzpicture}
    \caption{\textit{Зависност времена извршења паралелне имплементације \textit{BFS} алгоритма са дистрибуираном меморијом и једнодимензионим партиционисањем од броја потега}}
    \label{diagram:bfs-dist-1D-edge-numb-variable}
\end{figure}

\par
Дијаграм који илуструје однос броја процеса и времена потребног за проналажење растојања до досежних чворова из почетног чвора је приказан на слици \ref{diagram:bfs-dist-1D-process-numb-variable}. Подаци су приказани и у оквиру табеле \ref{table:bfs-dist-1D-process-variable}.

\begin{table}[H]
\centering
\rowcolors{2}{light blue}{}
\begin{tabular}{| m{.15\textwidth} | m{.15\textwidth} | m{.15\textwidth} | m{.15\textwidth} | m{.15\textwidth} |}
    \hline \rowcolor{dark blue}
     \textbw{Број темена} & \textbw{Максималан број потега} & \textbw{Минималан број потега} & \textbw{Време извршавања} & \textbw{Број процеса} \\ \hline
     1000 & 1000 & 100 & 0.139349 & 2 \\ \hline
     1000 & 1000 & 100 & 0.054088 & 4 \\ \hline
     1000 & 1000 & 100 & 0.034449 & 6 \\ \hline
     1000 & 1000 & 100 & 0.029910 & 8 \\ \hline
     1000 & 1000 & 100 & 0.027482 & 10 \\ \hline
     1000 & 1000 & 100 & 0.024727 & 12 \\ \hline
     1000 & 1000 & 100 & 0.025838 & 14 \\ \hline
     1000 & 1000 & 100 & 0.027829 & 16 \\ \hline
\end{tabular}
\caption{\textit{Перформансе паралелне имплементације \textit{BFS} алгоритма са дисртибуираном меморијом и једнодимензионим партиционисањем са променом броја процеса}}
\label{table:bfs-dist-1D-process-variable}
\end{table}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                xmode=log,
                log ticks with fixed point,
                xlabel={Број процеса},
                ylabel={Време извршења},
                width=.7\columnwidth
                ]
            \addplot+
            table[x=PN, y=T]{testovi/dist-1D-process-numb-variable.txt};
        \end{axis}
    \end{tikzpicture}
    \caption{\textit{Зависност времена извршења паралелне имплементације \textit{BFS} алгоритма са дистрибуираном меморијом и једнодимензионим партиционисањем од броја процеса}}
    \label{diagram:bfs-dist-1D-process-numb-variable}
\end{figure}